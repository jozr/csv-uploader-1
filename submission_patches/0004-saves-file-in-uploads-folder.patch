From 8f0726a9f5e2fef0fadb8bfc59a26c272169456f Mon Sep 17 00:00:00 2001
From: jozwright <jozwright@gmail.com>
Date: Mon, 1 Dec 2014 15:06:26 -0800
Subject: [PATCH 04/23] saves file in uploads folder

---
 example_data.csv         |  5 -----
 main.rb                  | 11 +++++++++++
 uploads/example_data.csv |  5 +++++
 views/index.erb          |  4 ++++
 4 files changed, 20 insertions(+), 5 deletions(-)
 delete mode 100644 example_data.csv
 create mode 100644 uploads/example_data.csv

diff --git a/example_data.csv b/example_data.csv
deleted file mode 100644
index 20b562b..0000000
--- a/example_data.csv
+++ /dev/null
@@ -1,5 +0,0 @@
-purchaser name,item description,item price,purchase count,merchant address,merchant name
-Snake Plissken,$10 off $20 of food,10.0,2,987 Fake St,Bob's Pizza
-Amy Pond,$30 of awesome for $10,10.0,5,456 Unreal Rd,Tom's Awesome Shop
-Marty McFly,$20 Sneakers for $5,5.0,1,123 Fake St,Sneaker Store Emporium
-Snake Plissken,$20 Sneakers for $5,5.0,4,123 Fake St,Sneaker Store Emporium
diff --git a/main.rb b/main.rb
index 1c35a1a..952c47f 100644
--- a/main.rb
+++ b/main.rb
@@ -1,9 +1,20 @@
+require 'pg'
 require 'sinatra'
 require 'sinatra/activerecord'
 require 'json'
 
 set :database, 'postgres://localhost/deal_a_day'
 
+class Detail < ActiveRecord::Base
+end
+
 get '/' do
   erb :index
+end
+
+post '/' do
+  File.open('uploads/' + params['upload'][:filename], "w") do |f|
+    f.write(params['upload'][:tempfile].read)
+  end
+  return "Your data was successfully uploaded!"
 end
\ No newline at end of file
diff --git a/uploads/example_data.csv b/uploads/example_data.csv
new file mode 100644
index 0000000..20b562b
--- /dev/null
+++ b/uploads/example_data.csv
@@ -0,0 +1,5 @@
+purchaser name,item description,item price,purchase count,merchant address,merchant name
+Snake Plissken,$10 off $20 of food,10.0,2,987 Fake St,Bob's Pizza
+Amy Pond,$30 of awesome for $10,10.0,5,456 Unreal Rd,Tom's Awesome Shop
+Marty McFly,$20 Sneakers for $5,5.0,1,123 Fake St,Sneaker Store Emporium
+Snake Plissken,$20 Sneakers for $5,5.0,4,123 Fake St,Sneaker Store Emporium
diff --git a/views/index.erb b/views/index.erb
index 8906672..c90d3f4 100644
--- a/views/index.erb
+++ b/views/index.erb
@@ -5,5 +5,9 @@
 </head>
 <body>
   <h1>Dr. Deal-a-Day</h1>
+  <form method="post" enctype="multipart/form-data" action="/">
+    <input type="file" name="upload" accept="file_extension">
+    <input type="submit" value="Upload!">
+  </form>
 </body>
 </html>
\ No newline at end of file
-- 
1.8.4

